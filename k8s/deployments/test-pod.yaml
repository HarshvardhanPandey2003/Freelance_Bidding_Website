apiVersion: v1
kind: Pod
metadata:
  name: test-secrets-pod
spec:
  containers:
  - name: test-container
    image: mcr.microsoft.com/oss/nginx/nginx:1.15.5-alpine
    volumeMounts:
    - name: secrets-store
      mountPath: "/mnt/secrets-store"
      readOnly: true
    env:
    - name: MONGODB_URI
      valueFrom:
        secretKeyRef:
          name: backend-secrets-k8s
          key: MONGODB_URI
    - name: JWT_SECRET
      valueFrom:
        secretKeyRef:
          name: backend-secrets-k8s
          key: JWT_SECRET
  volumes:
  - name: secrets-store
    csi:
      driver: secrets-store.csi.k8s.io
      readOnly: true
      volumeAttributes:
        secretProviderClass: "app-secrets-provider"
