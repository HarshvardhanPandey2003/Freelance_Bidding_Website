# apiVersion: apps/v1
# kind: StatefulSet  # Changed from Deployment
# metadata:
#   name: redis-cluster  # Changed name
#   labels:
#     app: redis-cluster
# spec:
#   serviceName: redis-cluster  # Required for StatefulSet
#   replicas: 6  # Changed from 1 to 6
#   selector:
#     matchLabels:
#       app: redis-cluster
#   template:
#     metadata:
#       labels:
#         app: redis-cluster
#     spec:
#       containers:
#       - name: redis
#         image: redis:7-alpine
#         ports:
#         - containerPort: 6379
#         - containerPort: 16379
#         command:  # Added cluster configuration
#         - redis-server
#         - --cluster-enabled
#         - "yes"
#         - --cluster-config-file
#         - "nodes.conf"
#         - --cluster-node-timeout
#         - "5000"
#         volumeMounts:
#         - name: redis-data
#           mountPath: /data
#   volumeClaimTemplates:  # Changed from emptyDir to persistent storage
#   - metadata:
#       name: redis-data
#     spec:
#       accessModes: ["ReadWriteOnce"]
#       resources:
#         requests:
#           storage: 10Gi
# ---
# apiVersion: v1
# kind: Service
# metadata:
#   name: redis-cluster  # Changed name
# spec:
#   clusterIP: None  # Changed to headless service
#   selector:
#     app: redis-cluster
#   ports:
#     - protocol: TCP
#       port: 6379
#       targetPort: 6379

# k8s-manifests/deployments/redis.yaml